<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.hrp.auth.mapper.TemplateConfigMapper">

    <resultMap id="BaseResultMap" type="com.hrp.common.entity.TemplateConfig">
        <id column="config_id" property="configId"/>
        <result column="business_type" property="businessType"/>
        <result column="business_type_value" property="businessTypeValue"/>
        <result column="business_type_name" property="businessTypeName"/>
        <result column="print_template_id" property="printTemplateId"/>
        <result column="print_template_name" property="printTemplateName"/>
        <result column="process_definition_id" property="processDefinitionId"/>
        <result column="process_definition_name" property="processDefinitionName"/>
        <result column="is_active" property="isActive"/>
        <result column="remark" property="remark"/>
        <result column="create_user" property="createUser"/>
        <result column="create_time" property="createTime"/>
        <result column="update_time" property="updateTime"/>
    </resultMap>

    <select id="selectById" resultMap="BaseResultMap">
        SELECT * FROM sys_template_config WHERE config_id = #{configId}
    </select>

    <select id="selectByBusinessType" resultMap="BaseResultMap">
        SELECT * FROM sys_template_config 
        WHERE business_type = #{businessType} 
        AND business_type_value = #{businessTypeValue}
        AND is_active = 1
        LIMIT 1
    </select>

    <select id="selectByBusinessTypeOnly" resultMap="BaseResultMap">
        SELECT * FROM sys_template_config 
        WHERE business_type = #{businessType}
        AND is_active = 1
        ORDER BY business_type_value ASC
    </select>

    <select id="selectAll" resultMap="BaseResultMap">
        SELECT * FROM sys_template_config ORDER BY business_type, business_type_value ASC
    </select>

    <select id="selectAllPage" resultMap="BaseResultMap">
        SELECT * FROM sys_template_config 
        ORDER BY business_type, business_type_value ASC
        LIMIT #{offset}, #{size}
    </select>

    <select id="countAll" resultType="Long">
        SELECT COUNT(*) FROM sys_template_config
    </select>

    <insert id="insert" parameterType="com.hrp.common.entity.TemplateConfig">
        INSERT INTO sys_template_config
        (business_type, business_type_value, business_type_name, 
         print_template_id, print_template_name, 
         process_definition_id, process_definition_name,
         is_active, remark, create_user, create_time)
        VALUES
        (#{businessType}, #{businessTypeValue}, #{businessTypeName},
         #{printTemplateId}, #{printTemplateName},
         #{processDefinitionId}, #{processDefinitionName},
         #{isActive}, #{remark}, #{createUser}, NOW())
    </insert>

    <update id="updateById" parameterType="com.hrp.common.entity.TemplateConfig">
        UPDATE sys_template_config
        <set>
            <if test="businessType != null">business_type = #{businessType},</if>
            <if test="businessTypeValue != null">business_type_value = #{businessTypeValue},</if>
            <if test="businessTypeName != null">business_type_name = #{businessTypeName},</if>
            <if test="printTemplateId != null">print_template_id = #{printTemplateId},</if>
            <if test="printTemplateName != null">print_template_name = #{printTemplateName},</if>
            <if test="processDefinitionId != null">process_definition_id = #{processDefinitionId},</if>
            <if test="processDefinitionName != null">process_definition_name = #{processDefinitionName},</if>
            <if test="isActive != null">is_active = #{isActive},</if>
            <if test="remark != null">remark = #{remark},</if>
            update_time = NOW()
        </set>
        WHERE config_id = #{configId}
    </update>

    <delete id="deleteById">
        DELETE FROM sys_template_config WHERE config_id = #{configId}
    </delete>

</mapper>

